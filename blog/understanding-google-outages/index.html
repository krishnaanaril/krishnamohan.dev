<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Scully 1.1.0">
  <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-118442837-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-118442837-2');
  </script>
  <meta charset="utf-8">
  <title>Understanding Google Outages on December 14, 2020</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <!-- <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> -->
  <link rel="manifest" href="manifest.json">  
  <link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">
  <meta name="theme-color" content="#1976d2">
<link rel="stylesheet" href="styles.c85254d7f2681ed00865.css"><style></style><script charset="utf-8" src="common-es2015.e42dcdd43780d81208f1.js"></script><script charset="utf-8" src="6-es2015.d141599c7f049700f633.js"></script><style>ol[_ngcontent-obm-c9]{list-style-type:decimal}ul[_ngcontent-obm-c9]{list-style-type:disc;padding-left:2.5rem}p[_ngcontent-obm-c9]{padding-top:1.25rem;padding-bottom:1.25rem}h2[_ngcontent-obm-c9]{font-size:1.875rem;line-height:2.25rem;margin-top:1.25rem;margin-bottom:1.25rem}h3[_ngcontent-obm-c9]{font-size:1.5rem;line-height:2rem;margin-top:.75rem;margin-bottom:.75rem}pre[_ngcontent-obm-c9]{font-size:1rem;line-height:1.5rem;margin-bottom:1.25rem;padding:1.25rem}a[_ngcontent-obm-c9]{--tw-border-opacity:1;border-color:rgba(37,99,235,var(--tw-border-opacity));border-bottom-width:2px}</style><meta name="title" content="Understanding Google Outages on December 14, 2020"><meta name="description" content="An overview of two major outages happened on 14th December, 2020. This is not an authoritative analysis but can be considered as notes regarding the aforesaid incidents."><meta name="og:type" content="article"><meta name="og:url" content="/blog/understanding-google-outages"><meta name="og:title" content="Understanding Google Outages on December 14, 2020"><meta name="og:description" content="An overview of two major outages happened on 14th December, 2020. This is not an authoritative analysis but can be considered as notes regarding the aforesaid incidents."><meta name="og:image" content="assets/banners/06"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="/blog/understanding-google-outages"><meta name="twitter:title" content="Understanding Google Outages on December 14, 2020"><meta name="twitter:description" content="An overview of two major outages happened on 14th December, 2020. This is not an authoritative analysis but can be considered as notes regarding the aforesaid incidents."><meta name="twitter:image" content="assets/banners/06"><meta name="twitter:site" content="@krishnaanaril"><meta name="twitter:creator" content="@krishnaanaril"><meta name="keywords" content="google, outage"><meta name="og:article:published_time" content="2021-01-06T00:00:00.000Z"><meta name="og:article:modified_time" content="2020-09-02T00:00:00.000Z"><meta name="og:article:author" content="Krishna Mohan A M"><meta name="og:article:section" content="Tech"><meta name="og:article:tag" content="google, outage"><style>
      :host {
        display: none;
      }
      scully-content {
        display: none;
      }
    </style><script>window['ScullyIO']='generated';</script></head>

<body scully-version="1.1.0">
  <app-root _nghost-obm-c7="" ng-version="11.2.2"><div _ngcontent-obm-c7="" class="bg-gray-200 text-gray-800 dark:bg-black dark:text-gray-50"><div _ngcontent-obm-c7="" class="container mx-auto bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-50"><section _ngcontent-obm-c7="" class="hidden lg:flex flex-row justify-center"><nav _ngcontent-obm-c7=""><ul _ngcontent-obm-c7="" class="lg:text-xl lg:flex lg:flex-row"><li _ngcontent-obm-c7="" routerlinkactive="border-b-2 border-gray-700 dark:border-gray-300" class="p-3 cursor-pointer" tabindex="0">Home</li><li _ngcontent-obm-c7="" routerlinkactive="border-b-2 border-gray-700 dark:border-gray-300" class="p-3 cursor-pointer border-b-2 border-gray-700 dark:border-gray-300" tabindex="0">Blog</li><li _ngcontent-obm-c7="" routerlinkactive="border-b-2 border-gray-700 dark:border-gray-300" class="p-3 cursor-pointer" tabindex="0">Projects</li><li _ngcontent-obm-c7="" routerlinkactive="border-b-2 border-gray-700 dark:border-gray-300" class="p-3 cursor-pointer" tabindex="0">About</li><!----></ul></nav></section><div _ngcontent-obm-c7="" class="absolute lg:hidden mr-4 p-4 right-0"><button _ngcontent-obm-c7="" aria-label="view menu items" class="p-2"><svg _ngcontent-obm-c7="" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="24px" height="24px" class="fill-current"><path _ngcontent-obm-c7="" d="M0 0h24v24H0z" fill="none"></path><path _ngcontent-obm-c7="" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div></div><!----><router-outlet _ngcontent-obm-c7=""></router-outlet><app-blog-post _nghost-obm-c9=""><div _ngcontent-obm-c9="" class="container mx-auto min-h-screen bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-50">
    <div _ngcontent-obm-c9="">
        <div _ngcontent-obm-c9="" aria-label="Blog tags/keywords" class="pt-8 flex flex-row justify-center">
            <div _ngcontent-obm-c9="" class="bg-gray-300 dark:bg-gray-700 border border-gray-400 ml-2 mr-2 pb-2 pl-4 pr-4 pt-2 text-sm align-baseline rounded-full">google</div><div _ngcontent-obm-c9="" class="bg-gray-300 dark:bg-gray-700 border border-gray-400 ml-2 mr-2 pb-2 pl-4 pr-4 pt-2 text-sm align-baseline rounded-full">outage</div><!---->
        </div>
        <div _ngcontent-obm-c9="" class="max-w-screen-lg mx-auto">
            <h1 _ngcontent-obm-c9="" class="text-5xl pt-5 pb-5 text-center">Understanding Google Outages on December 14, 2020</h1>
        </div>
        <div _ngcontent-obm-c9="" class="flex flex-row justify-center m-5 max-w-screen-sm mx-auto">
            <time _ngcontent-obm-c9="" class="text-center text-xl">Jan 6, 2021</time>
        </div>
    </div>
    <hr _ngcontent-obm-c9="" class="mx-auto border-gray-800 w-1/4">
    <div _ngcontent-obm-c9="" class="max-w-screen-md mx-auto p-6 md:p-12 leading-8">
        <!--scullyContent-begin--><p _ngcontent-obm-c9="">On that fateful day I was playing around with Youtube API to find a custom algorithm to avoid the default recommendations. All of sudden server errors started popping up for my API requests and for a moment I thought that I broke it. To verify this I logged in to Twitter and it was already trending there.</p>
<p _ngcontent-obm-c9="">There were multiple incidents on that day, but the most important were the Google cloud and Gmail outages.</p>
<h2 id="gmail-outage" _ngcontent-obm-c9="">Gmail Outage</h2>
<p _ngcontent-obm-c9="">For a period of 6 hours on that day, the service responsible for handling incoming SMTP connections incorrectly responded with an error (<a href="https://docs.microsoft.com/en-us/exchange/mail-flow-best-practices/non-delivery-reports-in-exchange-online/fix-error-code-550-5-1-1-through-5-1-20-in-exchange-online" _ngcontent-obm-c9="">hard bounce</a>) to emails being sent to “@gmail.com” users. The error message indicated that the email address did not exist and as a result, the impacted emails were never delivered.</p>
<p _ngcontent-obm-c9="">Email delivery to other email addresses on Google-hosted domains were not affected by this issue and continued to function correctly. SMTP clients conforming to email standards treat error code 550 as a permanent delivery error and do not attempt to resend the email. In response to a permanent delivery error, intermediate SMTP relays send a bounce email back to the original sender, informing them of the delivery error.</p>
<h3 id="root-cause" _ngcontent-obm-c9="">Root Cause</h3>
<p _ngcontent-obm-c9="">Google's SMPT inbound service has a configuration system to update flags and service options while deployed in production and ‘@gmail.com’ domain name is specified as one of the configuration options. During an ongoing migration, a configuration change shifted formatting behavior and provided and invalid domain name instead of “@gmail.com”. Due to this service incorrectly transformed lookups of certain email addresses ending in “@gmail.com” into non-existent email addresses resulting in 550 error code.</p>
<h3 id="remediation--prevention" _ngcontent-obm-c9="">Remediation &amp; Prevention</h3>
<p _ngcontent-obm-c9="">Upon identifying the root cause, engineering team reverted the code change which resolved the immediate issue. But when they again deployed the same configuration system the next day a similar issue occurred. Formatting error related to “@gmail.com” was identified in the internal logs and they have to again revert it.</p>
<p _ngcontent-obm-c9="">As per the official statement they’ll be taking necessary actions to guard against the issue recurring and to reduce the impact of similar events.
Impact on Other business</p>
<p _ngcontent-obm-c9="">Most impacted business are the email marketing platforms. Some of them even reported a peak of <a href="https://news.ycombinator.com/item?id=25437340" _ngcontent-obm-c9="">90% bounce</a> for almost 24 hours. Since the error code was 550, the email delivery services might’ve started automatically removing, or at least stopping delivery to, a set of email addresses. But on the brighter side, since it’s a known time frame, domain and error response, they can cleanly remove the suppression lists. An error code of 4xx (temporary error) might’ve reduced the impact and I’m not aware of any known side effects for this.</p>
<h2 id="google-cloud-outage" _ngcontent-obm-c9="">Google Cloud Outage</h2>
<p _ngcontent-obm-c9="">For a period of 47 minutes on the same day, Google services that required Google OAuth access were unavailable. Cloud service accounts used by GCP workloads were not impacted and continued to function</p>
<h3 id="root-cause-1" _ngcontent-obm-c9="">Root cause</h3>
<p _ngcontent-obm-c9="">Google uses an evolving suite of automation tools to manage the quota of various resources allocated for services. As part of an ongoing migration of the User ID Service to a new quota system, a change was made in October to register the User ID Service with the new quota system, but parts of the previous quota system were left in place which incorrectly reported the usage for the User ID Service as 0. An existing grace period on enforcing quota restrictions delayed the impact, which eventually expired, triggering automated quota systems to decrease the quota allowed for the User ID service and triggering this incident. Existing safety checks exist to prevent many unintended quota changes, but at the time they did not cover the scenario of zero reported load for a single service:</p>
<ul _ngcontent-obm-c9="">
<li _ngcontent-obm-c9="">Quota changes to large number of users, since only a single group was the target of the change,</li>
<li _ngcontent-obm-c9="">Lowering quota below usage, since the reported usage was inaccurately being reported as zero,</li>
<li _ngcontent-obm-c9="">Excessive quota reduction to storage systems, since no alert fired during the grace period,</li>
<li _ngcontent-obm-c9="">Low quota, since the difference between usage and quota exceeded the protection limit.</li>
</ul>
<p _ngcontent-obm-c9="">As a result, the quota for the account database was reduced, which prevented the <a href="(https://en.wikipedia.org/wiki/Paxos_(computer_science))" _ngcontent-obm-c9="">Paxos leader</a> from writing. Shortly after, the majority of read operations became outdated which resulted in errors on authentication lookups.</p>
<h3 id="remediation--prevention-1" _ngcontent-obm-c9="">Remediation &amp; Prevention</h3>
<p _ngcontent-obm-c9="">Once the root cause and potential fix were identified, engineers disabled the quota enforcement in one data canter. This quickly improved the situation and later the same mitigation was applied to all data-centres. As per the official statement they’ll be taking necessary actions to guard against the issue recurring and to reduce the impact of similar events.</p>
<h3 id="impact-on-business" _ngcontent-obm-c9="">Impact on business</h3>
<p _ngcontent-obm-c9="">Almost all google services were impacted by this outage. Most services recovered automatically within a short period of time after the main issue ended, but some services like Cloud Console, Google BigQuery and  K8s Engine had unique and lingering impact.</p>
<h2 id="references" _ngcontent-obm-c9="">References:</h2>
<ol _ngcontent-obm-c9="">
<li _ngcontent-obm-c9="">   <a href="https://static.googleusercontent.com/media/www.google.com/en//appsstatus/ir/4et50yp2ckm8otv.pdf" _ngcontent-obm-c9="">https://static.googleusercontent.com/media/www.google.com/en//appsstatus/ir/4et50yp2ckm8otv.pdf</a></li>
<li _ngcontent-obm-c9="">   <a href="https://status.cloud.google.com/incident/zall/20013" _ngcontent-obm-c9="">https://status.cloud.google.com/incident/zall/20013</a> </li>
</ol>
<!--scullyContent-end--><scully-content _ngcontent-obm-c9=""></scully-content>
    <script>try {window['scullyContent'] = {cssId:"_ngcontent-obm-c9",html:document.body.innerHTML.split('<!--scullyContent-begin-->')[1].split('<!--scullyContent-end-->')[0]};} catch(e) {console.error('scully could not parse content');}</script></div>
    <hr _ngcontent-obm-c9="" class="border-gray-800">    
</div><!----></app-blog-post><!----><footer _ngcontent-obm-c7="" class="container mx-auto flex flex-col bg-gray-200 text-gray-800 dark:bg-gray-800 dark:text-gray-50"><div _ngcontent-obm-c7="" class="mt-10"><ul _ngcontent-obm-c7="" class="flex flex-row justify-between max-w-sm mx-auto pl-4 pr-4"><li _ngcontent-obm-c7="" class="hover:text-gray-600 dark:hover:text-gray-100"><a _ngcontent-obm-c7="" href="https://twitter.com/KrishnaAnaril">Twitter</a></li><li _ngcontent-obm-c7=""><a _ngcontent-obm-c7="" href="https://krishnamohan.dev/sitemap-blog.xml">Sitemap</a></li><li _ngcontent-obm-c7=""><a _ngcontent-obm-c7="" href="https://krishnamohan.dev/feed.xml">RSS</a></li><li _ngcontent-obm-c7=""><a _ngcontent-obm-c7="" href="mailto:krishnamohan.a.m@gmail.com">Contact</a></li></ul></div><div _ngcontent-obm-c7="" class="mx-auto p-5 text-sm"><p _ngcontent-obm-c7="">© 2021-present <a _ngcontent-obm-c7="" href="https://krishnamohan.dev/" class="font-bold">Krishna Mohan A M</a>. All Rights Reserved.</p></div></footer></div></app-root>
  <noscript>Please enable JavaScript to continue using this application.</noscript>
<script id="ScullyIO-transfer-state"></script><script src="runtime-es2015.0c258286a84a90756f17.js" type="module"></script><script src="runtime-es5.0c258286a84a90756f17.js" nomodule="" defer=""></script><script src="polyfills-es5.29147128fc6f0f3fd286.js" nomodule="" defer=""></script><script src="polyfills-es2015.2045db6d95f407e1e8c7.js" type="module"></script><script src="main-es2015.eab9977039ea66e72c73.js" type="module"></script><script src="main-es5.eab9977039ea66e72c73.js" nomodule="" defer=""></script>

</body></html>